<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Box Constraints · NonlinearOptimizationTestFunctions.jl</title><meta name="title" content="Box Constraints · NonlinearOptimizationTestFunctions.jl"/><meta property="og:title" content="Box Constraints · NonlinearOptimizationTestFunctions.jl"/><meta property="twitter:title" content="Box Constraints · NonlinearOptimizationTestFunctions.jl"/><meta name="description" content="Documentation for NonlinearOptimizationTestFunctions.jl."/><meta property="og:description" content="Documentation for NonlinearOptimizationTestFunctions.jl."/><meta property="twitter:description" content="Documentation for NonlinearOptimizationTestFunctions.jl."/><meta property="og:url" content="https://uwealex.github.io/NonlinearOptimizationTestFunctions.jl/manual\\box_constraints.html"/><meta property="twitter:url" content="https://uwealex.github.io/NonlinearOptimizationTestFunctions.jl/manual\\box_constraints.html"/><link rel="canonical" href="https://uwealex.github.io/NonlinearOptimizationTestFunctions.jl/manual\\box_constraints.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">NonlinearOptimizationTestFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="installation.html">Installation</a></li><li><a class="tocitem" href="quickstart.html">Quick Start</a></li><li><a class="tocitem" href="usage.html">Usage</a></li><li><a class="tocitem" href="all_functions.html">All Functions</a></li><li class="is-active"><a class="tocitem" href="box_constraints.html">Box Constraints</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#How-the-Wrapper-Works"><span>How the Wrapper Works</span></a></li><li><a class="tocitem" href="#Comparison-with-Optim.jl&#39;s-Fminbox"><span>Comparison with Optim.jl&#39;s Fminbox</span></a></li><li><a class="tocitem" href="#Usage-Example"><span>Usage Example</span></a></li><li><a class="tocitem" href="#Recommendations"><span>Recommendations</span></a></li><li class="toplevel"><a class="tocitem" href="#Appendix:-Advantages-and-Differences-to-Traditional-L1-Wrappers"><span>Appendix: Advantages and Differences to Traditional L1 Wrappers</span></a></li><li><a class="tocitem" href="#Traditional-Exact-L1-Penalty-Methods"><span>Traditional Exact L1 Penalty Methods</span></a></li><li><a class="tocitem" href="#The-Package&#39;s-Domain-Safe-L1-Penalty-Wrapper"><span>The Package&#39;s Domain-Safe L1 Penalty Wrapper</span></a></li><li><a class="tocitem" href="#Key-Differences"><span>Key Differences</span></a></li><li><a class="tocitem" href="#Advantages-of-the-Domain-Safe-Wrapper"><span>Advantages of the Domain-Safe Wrapper</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="properties.html">Properties</a></li><li><a class="tocitem" href="testing.html">Testing</a></li><li><a class="tocitem" href="roadmap.html">Roadmap</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="box_constraints.html">Box Constraints</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="box_constraints.html">Box Constraints</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/UweAlex/NonlinearOptimizationTestFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/UweAlex/NonlinearOptimizationTestFunctions.jl/blob/master/docs/src/manual/box_constraints.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Box-Constraints-Handling-in-NonlinearOptimizationTestFunctions.jl"><a class="docs-heading-anchor" href="#Box-Constraints-Handling-in-NonlinearOptimizationTestFunctions.jl">Box Constraints Handling in NonlinearOptimizationTestFunctions.jl</a><a id="Box-Constraints-Handling-in-NonlinearOptimizationTestFunctions.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Box-Constraints-Handling-in-NonlinearOptimizationTestFunctions.jl" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Many benchmark functions in this package are <strong>bounded</strong> (i.e., defined only within specific lower and upper bounds <code>lb</code> and <code>ub</code>).   These bounds frequently define the <strong>valid domain</strong> of the function or its gradient (e.g., to avoid undefined operations like logarithms of negative values or division by zero).</p><p>To enable the use of <strong>unconstrained</strong> optimizers (e.g., LBFGS, BFGS, ConjugateGradient, GradientDescent, Newton, etc.) on these problems, the package provides a robust wrapper:</p><pre><code class="language-julia hljs">tf_unconstrained = with_box_constraints(tf)</code></pre><p>This wrapper implements a <strong>domain-safe modified exact L1 penalty</strong> approach specifically tailored for benchmark functions.</p><h2 id="How-the-Wrapper-Works"><a class="docs-heading-anchor" href="#How-the-Wrapper-Works">How the Wrapper Works</a><a id="How-the-Wrapper-Works-1"></a><a class="docs-heading-anchor-permalink" href="#How-the-Wrapper-Works" title="Permalink"></a></h2><p>The wrapper ensures <strong>safe evaluation</strong> while maintaining the benefits of an exact penalty method:</p><ul><li>Before evaluating the original objective <code>f(x)</code> or its gradient, the point <code>x</code> is <strong>clamped/projected</strong> to the feasible region:  <pre><code class="language-julia hljs">x_clamped = max.(lb, min.(x, ub))</code></pre></li><li>The original function and analytical gradient are <strong>always evaluated only inside the valid bounds</strong> (domain-safe evaluation).</li><li>An <strong>L1 penalty term</strong> with a large fixed parameter ρ = 10⁶ is added to discourage the optimizer from remaining unnecessarily at the boundary:   [ \tilde{f}(+x) = f(x<em>{\text{clamped}}) + \rho \sum</em>i \left( \max(0, l<em>i - x</em>i) + \max(0, x<em>i - u</em>i) \right) ]</li><li>The gradient is correctly adjusted using subgradients at the boundaries.</li></ul><p>This hybrid strategy combines the <strong>exactness</strong> of L1 penalties with the <strong>safety</strong> of projection, making it far more robust than pure penalty methods or projection-based approaches on functions with domain-restricted definitions.</p><p><strong>Key advantage</strong>: The wrapper works with <strong>any unconstrained optimization method</strong> available in Optim.jl, GalacticOptim.jl, or custom implementations — you are not restricted to a specific algorithm.</p><h2 id="Comparison-with-Optim.jl&#39;s-Fminbox"><a class="docs-heading-anchor" href="#Comparison-with-Optim.jl&#39;s-Fminbox">Comparison with Optim.jl&#39;s Fminbox</a><a id="Comparison-with-Optim.jl&#39;s-Fminbox-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-Optim.jl&#39;s-Fminbox" title="Permalink"></a></h2><p>Optim.jl provides <code>Fminbox</code>, a built-in box-constrained optimizer that combines an unconstrained method with gradient projection and resetting at bounds.   <strong>Limitation</strong>: <code>Fminbox</code> currently only supports <strong>LBFGS</strong> as the inner solver.</p><p>A comprehensive benchmark (<code>examples/benchmark_box_constraints.jl</code>, December 2025) compares:</p><ul><li><code>Fminbox</code> + LBFGS (standard linesearch)</li><li><code>with_box_constraints</code> + LBFGS with <strong>BackTracking</strong> linesearch</li></ul><p><strong>Benchmark results</strong> (155 bounded functions, 10 random strictly feasible starts each):</p><ul><li><strong>Robustness</strong> (higher success rate):<ul><li>L1 wrapper more robust: <strong>~120 functions</strong></li><li>Fminbox more robust: <strong>~15 functions</strong></li><li>Equal robustness (&gt;0% success): <strong>~20 functions</strong></li></ul></li><li>The wrapper frequently converges where <code>Fminbox</code> fails (e.g., due to NaN in projected gradients on functions like <code>bartelsconn</code>, <code>rump</code>, <code>alpinen1</code>, <code>bukin*</code>).</li><li>When both converge, the wrapper is typically <strong>faster</strong> (fewer total function + gradient calls).</li></ul><p>Overall, the wrapper is <strong>more robust</strong>, often <strong>more efficient</strong>, and <strong>significantly more flexible</strong> (any optimizer) than <code>Fminbox</code>.</p><h2 id="Usage-Example"><a class="docs-heading-anchor" href="#Usage-Example">Usage Example</a><a id="Usage-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using NonlinearOptimizationTestFunctions
using Optim
using LineSearches  # recommended for the wrapper

# Select a bounded test function
tf_orig = ACKLEY_FUNCTION
tf = fixed(tf_orig; n = 10)  # fix dimension if scalable

# Apply the domain-safe wrapper
tf_unconstrained = with_box_constraints(tf)

# Use any unconstrained optimizer (LBFGS with BackTracking recommended)
optimizer = LBFGS(linesearch = BackTracking())

# Strictly feasible random start point (recommended)
lower = Float64.(lb(tf))
upper = Float64.(ub(tf))
x0 = lower + (upper - lower) .* rand(length(lower))
x0 = clamp.(x0, lower + 1e-8, upper - 1e-8)  # ensure strict feasibility

# Optimize
result = optimize(tf_unconstrained.f, tf_unconstrained.gradient!,
                  x0, optimizer,
                  Optim.Options(f_reltol = 1e-8, iterations = 20_000))

println(&quot;Converged: &quot;, Optim.converged(result))
println(&quot;Minimizer: &quot;, Optim.minimizer(result))
println(&quot;Minimum:   &quot;, Optim.minimum(result))</code></pre><h2 id="Recommendations"><a class="docs-heading-anchor" href="#Recommendations">Recommendations</a><a id="Recommendations-1"></a><a class="docs-heading-anchor-permalink" href="#Recommendations" title="Permalink"></a></h2><ul><li>Use <code>with_box_constraints</code> for <strong>maximum robustness and flexibility</strong>, especially on functions where bounds define the valid domain.</li><li>Pair it with <code>LBFGS(linesearch = BackTracking())</code> or <code>BackTracking(order=3)</code> for best handling of the non-smooth penalty.</li><li>Use <code>Fminbox</code> only if you specifically need its projection behavior and accept the limitation to LBFGS.</li></ul><p>The wrapper makes the entire collection of bounded test functions safely usable with <strong>any</strong> unconstrained optimizer while delivering excellent practical performance.</p><h1 id="Appendix:-Advantages-and-Differences-to-Traditional-L1-Wrappers"><a class="docs-heading-anchor" href="#Appendix:-Advantages-and-Differences-to-Traditional-L1-Wrappers">Appendix: Advantages and Differences to Traditional L1 Wrappers</a><a id="Appendix:-Advantages-and-Differences-to-Traditional-L1-Wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix:-Advantages-and-Differences-to-Traditional-L1-Wrappers" title="Permalink"></a></h1><p>This appendix compares the package&#39;s <code>with_box_constraints</code> wrapper to traditional exact L1 penalty methods, highlighting its domain-safe design and practical benefits.</p><h2 id="Traditional-Exact-L1-Penalty-Methods"><a class="docs-heading-anchor" href="#Traditional-Exact-L1-Penalty-Methods">Traditional Exact L1 Penalty Methods</a><a id="Traditional-Exact-L1-Penalty-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Traditional-Exact-L1-Penalty-Methods" title="Permalink"></a></h2><p>In classical exact L1 penalty approaches (e.g., as described in optimization literature), a constrained problem (\min f(x)) s.t. (l \leq x \leq u) is transformed into an unconstrained one:</p><p>[ \tilde{f}(x) = f(x) + \rho \sum<em>i \left( \max(0, l</em>i - x<em>i) + \max(0, x</em>i - u_i) \right) ]</p><ul><li>Evaluations of (f(x)) and (\nabla f(x)) occur <strong>directly at the unbound (x)</strong>, even if outside bounds.</li><li>For sufficiently large fixed (\rho &gt; \rho^*) (threshold based on Lagrange multipliers), local minima coincide exactly.</li><li>Gradient: (\nabla \tilde{f}(x) = \nabla f(x) + \rho \sum<em>i \partial v</em>i(x)), where (v_i(x)) is the bound violation (subgradient at kinks).</li></ul><p>This works well for functions defined everywhere but can fail if (f) or (\nabla f) is undefined/unstable outside bounds (e.g., domain errors like (\log(x)) for (x &lt; 0)).</p><h2 id="The-Package&#39;s-Domain-Safe-L1-Penalty-Wrapper"><a class="docs-heading-anchor" href="#The-Package&#39;s-Domain-Safe-L1-Penalty-Wrapper">The Package&#39;s Domain-Safe L1 Penalty Wrapper</a><a id="The-Package&#39;s-Domain-Safe-L1-Penalty-Wrapper-1"></a><a class="docs-heading-anchor-permalink" href="#The-Package&#39;s-Domain-Safe-L1-Penalty-Wrapper" title="Permalink"></a></h2><p>The <code>with_box_constraints</code> implements a <strong>modified exact L1 penalty</strong> with pre-clamping:</p><ul><li><p>Compute (x_{\text{clamped}} = \max(l, \min(x, u))).</p></li><li><p>Penalized objective:   [ \tilde{f}(x) = f(x<em>{\text{clamped}}) + \rho \sum</em>i v_i(x) ] (fixed (\rho = 10^6)).</p></li><li><p>Gradient: (\nabla \tilde{f}(x) = \nabla f(x<em>{\text{clamped}}) + \rho \sum</em>i \partial v_i(x)) (subgradient-adjusted).</p></li><li><p>(f) and (\nabla f) are <strong>always evaluated inside the valid domain</strong> (at (x_{\text{clamped}})).</p></li><li><p>The penalty on unbound (x) ensures the gradient &quot;pulls inward&quot; for violations.</p></li></ul><h2 id="Key-Differences"><a class="docs-heading-anchor" href="#Key-Differences">Key Differences</a><a id="Key-Differences-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Differences" title="Permalink"></a></h2><ul><li><strong>Evaluation Point</strong>: Traditional methods evaluate at unbound (x) (risking domain errors). The wrapper clamps first, ensuring domain-safety.</li><li><strong>Handling Violations</strong>: Both penalize violations, but the wrapper&#39;s clamping prevents unstable evaluations while the penalty corrects the direction.</li><li><strong>Exactness</strong>: Both are exact for large (\rho), but the wrapper&#39;s hybrid (clamp + penalty) adds safety without losing theoretical guarantees (as long as (\rho) dominates the clamped gradient).</li><li><strong>Smoothness</strong>: Both are non-smooth (kinks from max/abs), but the wrapper&#39;s clamping can make the effective landscape &quot;smoother&quot; near bounds by avoiding explosions in (f).</li><li><strong>Flexibility</strong>: The wrapper supports any unconstrained optimizer; traditional penalties do too, but without domain-safety, they may crash on benchmark functions.</li></ul><h2 id="Advantages-of-the-Domain-Safe-Wrapper"><a class="docs-heading-anchor" href="#Advantages-of-the-Domain-Safe-Wrapper">Advantages of the Domain-Safe Wrapper</a><a id="Advantages-of-the-Domain-Safe-Wrapper-1"></a><a class="docs-heading-anchor-permalink" href="#Advantages-of-the-Domain-Safe-Wrapper" title="Permalink"></a></h2><ol><li><strong>Domain Safety</strong>: Always evaluates within bounds, preventing NaN, Inf, or DomainErrors—critical for benchmarks with hard domains (e.g., logs, roots).</li><li><strong>Guaranteed Inward Pull</strong>: The penalty dominates violations, ensuring the gradient pulls components &quot;inward&quot; without being overpowered by unstable external gradients (as in traditional methods).</li><li><strong>Robustness</strong>: As shown in benchmarks, higher success rates on ill-conditioned or non-differentiable functions where traditional penalties or projections (e.g., Fminbox) fail.</li><li><strong>Efficiency</strong>: Fewer calls in practice (avoids wasted evaluations outside domain) and better numerical stability.</li><li><strong>Ease of Use</strong>: Seamless for any gradient-based unconstrained solver, with no need for custom projections.</li></ol><p>This design makes the wrapper particularly suited for test function libraries, where bounds often define validity rather than just constraints.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="all_functions.html">« All Functions</a><a class="docs-footer-nextpage" href="examples.html">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 20 December 2025 08:32">Saturday 20 December 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
